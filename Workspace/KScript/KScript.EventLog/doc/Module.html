<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>HTML TABLE</title>
</head><body>
<DIV><P><FONT size=1 color=#969696>Back to [[Module reference]]</FONT></P></DIV>
<DIV><STRONG><FONT size=4>Contents</FONT></STRONG></DIV>
&nbsp;
<DIV>
<A HREF='http://sites.eu.kworld.kpmg.com/sites/infrastructure/department/itservices/coretechnologies/KScript/KScript.EventLog.aspx#ModuleInformation'>Module information</A><BR />
<A HREF='http://sites.eu.kworld.kpmg.com/sites/infrastructure/department/itservices/coretechnologies/KScript/KScript.EventLog.aspx#Functions'>Functions</A><BR />
</DIV>
&nbsp;<HR>&nbsp;
<DIV><A Name='ModuleInformation'></A><STRONG><FONT size=4>Module information</FONT></STRONG></DIV>
&nbsp;
<DIV>
<P>CmdLets and functions used to query and manipulate event logs</P>
<UL>
<LI>Module version: 1.54</LI>
<LI>Author: Chris Dent</LI>
<LI>Page updated: Wednesday 12 November 2014</LI>
</UL>
</DIV>
&nbsp;<HR>&nbsp;
<DIV><A Name='Functions'></A><STRONG><FONT size=4>Functions</FONT></STRONG></DIV>
&nbsp;
<DIV>
<TABLE style="WIDTH: 100%; BORDER-COLLAPSE: collapse; FONT-SIZE: 1em" border=1>
<tr><th style="background-color: #98C6F3;">Name</th><th style="background-color: #98C6F3;">Description</th><th style="background-color: #98C6F3;">Author</th><th style="background-color: #98C6F3;">Last modified</th><th style="background-color: #98C6F3;">Modified by</th></tr>
<tr><td><a href='http://sites.eu.kworld.kpmg.com/sites/infrastructure/department/itservices/coretechnologies/KScript/KScript.EventLog.aspx#Get-KSAccountLockoutLog'>Get-KSAccountLockoutLog</a></td><td>Get event logs associated with account lockout.</td><td>Chris Dent</td><td>12/11/2014</td><td>Chris Dent</td></tr>
<tr><td><a href='http://sites.eu.kworld.kpmg.com/sites/infrastructure/department/itservices/coretechnologies/KScript/KScript.EventLog.aspx#Get-KSUnexpectedRebootEvent'>Get-KSUnexpectedRebootEvent</a></td><td>Get unexpected reboot events.</td><td>Chris Dent</td><td>30/10/2014</td><td>Chris Dent</td></tr>
<tr><td><a href='http://sites.eu.kworld.kpmg.com/sites/infrastructure/department/itservices/coretechnologies/KScript/KScript.EventLog.aspx#Invoke-KSGetWinEvent'>Invoke-KSGetWinEvent</a></td><td>Invoke-KSGetWinEvent wraps around Get-WinEvent.</td><td>Chris Dent</td><td>17/06/2014</td><td>Chris Dent</td></tr>
</table>
</DIV>
&nbsp;<HR>&nbsp;
<DIV><A Name='Get-KSAccountLockoutLog'></A><STRONG><FONT size=4>Get-KSAccountLockoutLog</FONT></STRONG></DIV>
&nbsp;
<DIV><STRONG><FONT size=2>Synopsis</FONT></STRONG></DIV>
<P>Get event logs associated with account lockout.</P>
<DIV><STRONG><FONT size=2>Syntax</FONT></STRONG></DIV>
<P style='font-family: Consolas'>Get-KSAccountLockoutLog [-SamAccountName] &lt;String&gt; [-ShowAllEvents] [[-EventcombmtPath] &lt;String&gt;] [[-LogWindow] &lt;TimeSpan&gt;] [[-WorkingDirectory] &lt;String&gt;] [[-MaximumLogAge] &lt;TimeSpan&gt;] [-DebugLogSearcher] [&lt;CommonParameters&gt;]</P>
<DIV><STRONG><FONT size=2>Description</FONT></STRONG></DIV>
<P>Looking for account lockout is a multi-step process:</P>
<OL><LI>Find all Domain Controllers</LI><LI>Find values for BadPasswordTime for the user</LI><LI>Create a window (based on the LogWindow parameter) prior to the most recent BadPasswordTime value.</LI><LI>Search the event log on the Domain Controller holding that value.</LI><LI>Search the event log on the PDCe.</LI><LI>Read the log file and return the client IP responsible for generating the error.</LI><LI>Attempt to lookup the host name for the client in a reverse lookup zone.</LI></OL><P>EventCombMT is used to search event logs. EventCombMT is shipped with this module, but may be separately downloaded as part of the Account Lockout Tools.</P>
<P>http://www.microsoft.com/en-gb/download/details.aspx?id=18465</P>
<P>Log files generated by eventcombmt are saved in a LogResults sub-directory under $WorkingDirectory. Results are read from the file and returned by this function.</P>
&nbsp;<DIV><STRONG><FONT size=2>Change log</FONT></STRONG></DIV>
&nbsp;
<DIV>
<TABLE style="WIDTH: 70%; BORDER-COLLAPSE: collapse; FONT-SIZE: 1em" border=1>
<tr><th style="background-color: #98C6F3;">Date</th><th style="background-color: #98C6F3;">Who</th><th style="background-color: #98C6F3;">What</th></tr>
<tr><td>12/11/2014</td><td>Chris Dent</td><td>Added check for Administrative token prior to executing search. Changed method to always check PDCe for events.</td></tr>
<tr><td>31/10/2014</td><td>Chris Dent</td><td>BugFix: Unintended return value from New-Item. Limited Get-KSADDomainController property set to Name.</td></tr>
<tr><td>23/09/2014</td><td>Chris Dent</td><td>Added EventID 644.</td></tr>
<tr><td>15/08/2014</td><td>Chris Dent</td><td>Changed match to account for EventID 680 (as well as 675). Added ShowAllEvents parameter.</td></tr>
<tr><td>13/08/2014</td><td>Chris Dent</td><td>Broke pipeline (caused DS timeout error). Fixed bad field name for AuthenticatingIP.</td></tr>
<tr><td>12/08/2014</td><td>Chris Dent</td><td>BugFix: File deletion. Redesigned output. Prevented event log query executing if badPasswordTime older than MaximumLogAge.</td></tr>
<tr><td>26/06/2014</td><td>Chris Dent</td><td>Removed mandatory flag from EventCombmtPath</td></tr>
<tr><td>25/06/2014</td><td>Chris Dent</td><td>First release.</td></tr>
</table>
</DIV>
&nbsp;<HR>&nbsp;
<DIV><A Name='Get-KSUnexpectedRebootEvent'></A><STRONG><FONT size=4>Get-KSUnexpectedRebootEvent</FONT></STRONG></DIV>
&nbsp;
<DIV><STRONG><FONT size=2>Synopsis</FONT></STRONG></DIV>
<P>Get unexpected reboot events.</P>
<DIV><STRONG><FONT size=2>Syntax</FONT></STRONG></DIV>
<P style='font-family: Consolas'>Get-KSUnexpectedRebootEvent [[-ComputerName] &lt;String[]&gt;] [[-After] &lt;DateTime&gt;] [[-JobLimit] &lt;UInt32&gt;] [&lt;CommonParameters&gt;]</P>
<DIV><STRONG><FONT size=2>Description</FONT></STRONG></DIV>
<P>Gets unexpected reboot events (Event ID 6008) and attempts to correlate administrative acknowledgement (Event ID 1076) and any bug check messages (Event ID 1001). Event correlation is best-effort and may not be correct.</P>
<P>The event log query is run as parallel jobs. Pseudo-threading is managed by the function using *-Job.</P>
&nbsp;<DIV><STRONG><FONT size=2>Change log</FONT></STRONG></DIV>
&nbsp;
<DIV>
<TABLE style="WIDTH: 70%; BORDER-COLLAPSE: collapse; FONT-SIZE: 1em" border=1>
<tr><th style="background-color: #98C6F3;">Date</th><th style="background-color: #98C6F3;">Who</th><th style="background-color: #98C6F3;">What</th></tr>
<tr><td>30/10/2014</td><td>Chris Dent</td><td>BugFix: CmdLet name changes.</td></tr>
<tr><td>17/06/2014</td><td>Chris Dent</td><td>Redesigned, fixed error handling and added a wrapper for Get-WinEvent.</td></tr>
<tr><td>05/06/2014</td><td>Chris Dent</td><td>First release.</td></tr>
</table>
</DIV>
&nbsp;<HR>&nbsp;
<DIV><A Name='Invoke-KSGetWinEvent'></A><STRONG><FONT size=4>Invoke-KSGetWinEvent</FONT></STRONG></DIV>
&nbsp;
<DIV><STRONG><FONT size=2>Synopsis</FONT></STRONG></DIV>
<P>Invoke-KSGetWinEvent wraps around Get-WinEvent.</P>
<DIV><STRONG><FONT size=2>Syntax</FONT></STRONG></DIV>
<P style='font-family: Consolas'>Invoke-KSGetWinEvent [&lt;CommonParameters&gt;]</P>
<DIV><STRONG><FONT size=2>Description</FONT></STRONG></DIV>
<P>Invoke-KSGetWinEvent provides a wrapper for Get-WinEvent to resolve a bug which prevents several fields returning when run in cultures other than en-US.</P>
<P>Invoke-KSGetWinEvent continually switches culture to ensure display formats are consistent with the current culture.</P>
<P>For usage, refer to documentation for Get-WinEvent.</P>
&nbsp;<DIV><STRONG><FONT size=2>Change log</FONT></STRONG></DIV>
&nbsp;
<DIV>
<TABLE style="WIDTH: 70%; BORDER-COLLAPSE: collapse; FONT-SIZE: 1em" border=1>
<tr><th style="background-color: #98C6F3;">Date</th><th style="background-color: #98C6F3;">Who</th><th style="background-color: #98C6F3;">What</th></tr>
<tr><td>17/06/2014</td><td>Chris Dent</td><td>First release</td></tr>
</table>
</DIV>
&nbsp;<HR>&nbsp;

<table>
</table>
</body></html>

